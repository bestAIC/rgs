app={},$(function(){app.init()}),app.dom={$window:$(window),$body:$("body"),$document:$(document),$grid:$(".grid"),$header:$(".header"),$footer:$(".footer")},app.utils={},app.utils.isTabletLand=!!(device.tablet()&&$(window).width()>$(window).height()),app.utils.isTabletPort=!!(device.tablet()&&$(window).width()<$(window).height()),app.utils.isMobileLand=!!(device.mobile()&&$(window).width()>$(window).height()),app.utils.isMobilePort=!!(device.mobile()&&$(window).width()<$(window).height()),app.utils.isMobile=device.mobile(),app.utils.isTablet=device.tablet(),app.utils.parseUrlQuery=function(a){var e,t,i,n=a&&a.indexOf("?"),o={};if(a=a?n!==-1?a.substr(n+1):null:location.search&&location.search.substr(1))for(i=a.split("&"),e=0;e<i.length;e++)t=i[e].split("="),o[t[0]]=t[1];return o},app.utils.getData=app.utils.parseUrlQuery(window.location.search),app.utils.okonchanie=function(a,e,t,i){var n=parseInt(a)!==parseFloat(a);return a+="",a.length>1&&"1"==+a.substr(a.length-2,1)||+a.substr(a.length-1,1)>4&&+a.substr(a.length-1,1)<10&&!n?i:"1"!=a.substr(a.length-1,1)||n?t:e},app.init=function(){app.utils.getData["goto"]&&($("html, body").stop(!0,!0),setTimeout(function(){$("html, body").stop(!0,!0).animate({scrollTop:$(app.utils.getData["goto"]).offset().top-$("[data-menu-wrap]").height()},500)},500)),$("input[type=checkbox], input[type=radio]").idealRadioCheck(),app.initFluid(),app.newsGall(),app.menu(),app.masks(),app.bannerGall(),app.initAnimations(),app.info(),app.initMaps(),app.questions(),app.initNav(),app.calc(),app.calcFilter(),app.initTabs(),app.initBaseCheck(),app.chooseCity(),app.initGoto(),app.CardP2P(),app.transfersMenu(),app.askForm(),app.actions(),app.oldVersion(),app.payFonds(),app.depository(),app.faqMobTabs(),app.docsDateYears(),app.experts(),app.dataFile(),app.vacancies(),app.initSwitch(),app.investCalc(),app.resumeForm(),app.mortgageCalc(),app.fieldFilter(),app.shareholdersChart(),app.utils.isMobile||app.utils.isTablet?app.initForms():app.initChosen(),(app.utils.isMobile||app.utils.isTabletPort)&&(app.tabletSliders(),app.compare()),app.utils.isMobile&&app.mobSliders(),$("[data-not-found]").length&&app.dom.$body.addClass("not-found"),$("[data-offices-page]").length&&app.dom.$body.addClass("is-offices-page"),$("[data-white-top]").length&&app.dom.$body.addClass("white-top"),$("[data-old-browser]").length&&app.dom.$body.addClass("_old-browser"),$("html").on("click","[data-fancy-close]",function(){$.fancybox.close()})},app.investCalc=function(){function a(a){m.text(a.text),h.text(a.deposit+"%"),v.text(a.insurance+"%"),g.text(a.iis+"%");var e=parseInt(d.val().replace(new RegExp(" ","g"),""),10),t=[{category:"",value1:a.deposit,value2:a.insurance,value3:a.iis}];AmCharts.makeChart(n[0],{theme:"light",type:"serial",depth3D:100,angle:15,startDuration:1,marginTop:20,marginBottom:40,marginLeft:50,marginRight:10,dataProvider:t,valueAxes:[{stackType:"100%",gridAlpha:0}],graphs:[{title:"депозит",type:"column",topRadius:1,columnWidth:1,showOnAxis:!0,lineThickness:0,lineAlpha:.5,lineColor:"#e6ddd1",fillColors:"#e6ddd1",fillAlphas:1,valueField:"value1",labelOffset:0,labelText:app.formatNumber(parseInt(e/100*a.deposit))+"P",balloonText:app.formatNumber(parseInt(e/100*a.deposit))+"P <b>([[value]]</b>%)"},{title:"исж",type:"column",topRadius:1,columnWidth:1,showOnAxis:!0,lineThickness:2,lineAlpha:.5,lineColor:"#e6c79d",fillColors:"#e6c79d",fillAlphas:1,valueField:"value2",labelText:app.formatNumber(parseInt(e/100*a.insurance))+"P",labelOffset:0,balloonText:app.formatNumber(parseInt(e/100*a.insurance))+"P <b>([[value]]</b>%)"},{title:"иис",type:"column",topRadius:1,columnWidth:1,showOnAxis:!0,lineThickness:2,lineAlpha:.5,lineColor:"#cc1f33",fillColors:"#cc1f33",fillAlphas:1,valueField:"value3",labelText:app.formatNumber(parseInt(e/100*a.iis))+"P",labelOffset:0,balloonText:app.formatNumber(parseInt(e/100*a.iis))+"P <b>([[value]]</b>%)"}],categoryField:"category",categoryAxis:{axisAlpha:0,labelOffset:0,position:"right",gridAlpha:0},"export":{enabled:!1},balloon:{animationDuration:.52},legend:{enabled:!0,useGraphSettings:!0,labelWidth:50,maxColumns:3,valueWidth:0}})}function e(a){var e=null;for(var t in p)t=parseInt(t),t<=a&&(e=t);return p[e]}var t=$("[data-invest-calc]"),i=t.find("form"),n=t.find("[data-invest-calc-chart]"),o=t.find("[data-invest-calc-reset]"),s=t.find("[data-invest-calc-step]"),r=t.find("[data-invest-calc-goto]"),l=t.find("[data-invest-calc-answer]"),d=t.find("[data-invest-calc-sum]"),c=t.find("[ data-invest-calc-question-btn]"),p=null,f=0,u=t.find("[data-result]"),m=u.find("[data-result-text]"),h=u.find("[data-result-deposit]"),v=u.find("[data-result-insurance]"),g=u.find("[data-result-iis]");return!!t.length&&($.post(i.attr("action"),{},function(a){p=$.parseJSON(a)}),o.on("click",function(){var a=l.filter(":checked");a.prop("checked",!1).change(),c.addClass("_disabled")}),d.focus(function(){var a=parseInt(d.val().replace(new RegExp(" ","g"),""),10);d.val(a)}).keyup(function(){}),d.on("change",function(){var t=parseInt(d.val().replace(new RegExp(" ","g"),""),10);t=Math.max(0,t),t||(t=0),d.val(app.formatNumber(t)),a(e(f))}),l.on("change",function(){$(this).closest(s).find(r).removeClass("_disabled")}),void r.on("click",function(){var t=$(this),i=t.data("investCalcGoto");return!t.hasClass("_disabled")&&("result"==i&&(f=0,l.filter(":checked").each(function(){f+=parseInt($(this).val())}),a(e(f))),void s.hide().filter('[data-invest-calc-step="'+i+'"]').show())}))},app.askForm=function(){var a=$("[data-ask]"),e=a.find("form"),t=a.find("[data-ask-field]"),i=$("[data-ask-content]"),n=null;i.find("form").on("submit",function(){var a=$(this),e=a.find("[data-form-errors]");return $.post(a.attr("action"),a.serialize(),function(a){a.errors?e.html(a.errors).show():(e.hide(),$.fancybox.close())},"json"),!1}),e.on("submit",function(){return n=i.filter('[data-ask-content="'+t.val()+'"]'),$.fancybox({wrapCSS:"fc-base _forms",content:n,fitToView:!1,padding:0,helpers:{overlay:{css:{background:"rgba(0, 0, 0, 0.5)"}}}}),!1})},app.experts=function(){var a=$("[data-experts]"),e=a.find("[data-experts-form]"),t=e.find("[data-experts-form-theme]"),i=e.find("[data-experts-form-expert]"),n=e.find("[data-experts-form-expert-name]"),o=a.find("[data-experts-item]"),s=o.find("[data-experts-item-btn]"),r=o.find("[data-experts-item-theme]"),l=e.find("[data-form-errors]");e.find("form").on("submit",function(){var a=$(this),t=new FormData(a.get(0));return $.ajax({url:a.attr("action"),type:"POST",contentType:!1,processData:!1,data:t,dataType:"json",success:function(a){a.errors?l.html(a.errors).show():(l.hide(),e.find("form").hide(),e.find("[data-success]").show())}}),!1}),s.on("click",function(){var a=$(this),s=a.data("expertsItemBtn");return l.hide(),e.find("form").show(),e.find("[data-success]").hide(),i.val(s.email),n.text(s.name),t.html(a.closest(o).find(r).html()),t.trigger("chosen:updated"),$.fancybox({wrapCSS:"fc-base _forms",content:e,fitToView:!1,padding:0,helpers:{overlay:{css:{background:"rgba(0, 0, 0, 0.5)"}}}}),!1})},app.actions=function(){var a=$("[data-actions]"),e=a.find("form"),t=e.find("[data-actions-form-field]"),i=a.find("[data-actions-items]");t.on("change",function(){e.trigger("submit")}),e.on("submit",function(){var a=$(this);return $.post(a.attr("action"),a.serialize(),function(a){i.html(a)}),!1}),i.on("click","[data-actions-item-more]",function(){var a=$(this),e=a.closest("[data-actions-item]").find("[data-actions-item-content]").html();$.fancybox({wrapCSS:"fc-base _empty",content:e,fitToView:!1,padding:0,helpers:{overlay:{css:{background:"rgba(0, 0, 0, 0.5)"}}}})})},app.welcome=function(){var a=$("[data-welcome]");getCookie("welcomeWasShown")||($.fancybox({wrapCSS:"fc-base _welcome",content:a,fitToView:!1,padding:0,helpers:{overlay:{css:{background:"rgba(0, 0, 0, 0.5)"}}}}),setCookie("welcomeWasShown",!0,{path:"/"}))},app.oldVersion=function(){var a=$("[data-old-version]"),e=a.find("[data-old-version-close]");e.on("click",function(){a.hide()})},app.dataFile=function(){var a=$("[data-file]"),e=a.find("[data-file-text]"),t=a.find("[data-file-inp]");t.on("change",function(){var t=$(this),i=t.closest(a),n=t.val().replace("C:\\fakepath\\","");""==n&&(n=i.find(e).data("fileText")),i.find(e).text(n)})},app.CardP2P=function(){function a(){s.find("[data-card-mask]").mask("0000 0000 0000 0999999",{clearIfNotMatch:!0}),s.find("[data-cvv-mask]").mask("000",{clearIfNotMatch:!0}),s.find("[data-date-mask]").mask("A0/00",{clearIfNotMatch:!0,translation:{A:{pattern:/[0-1]/},B:{pattern:/[0-2]/},C:{pattern:/[1-9]/}},onKeyPress:function(a,e,t,i){var n=["AC/00","AB/00"],o=1==a.charAt(0)?n[1]:n[0];s.find("[data-date-mask]").mask(o,i)}}),s.find("[data-sum-mask]").mask("# ##0",{reverse:!0}),s.find("[data-sum-mask]").on("change",function(){var a=$(this).val().replace(new RegExp(" ","g"),"");a<50&&$(this).val(""),a>75e3&&$(this).val("75 000").change()}),s.find("[data-name-mask]").mask("S",{translation:{S:{pattern:/[a-zA-Z\s]/,recursive:!0}}})}function e(a){var e=!0;return a.each(function(){""==$.trim($(this).val())&&(e=!1)}),e}function t(a){return $.ajax({url:"/ajax/cards/registration/",dataType:"JSON",type:"GET",success:function(e){a&&a(e)},error:function(a){o(a)}})}function i(a){return $.ajax({url:"/ajax/cards/verifycation/",dataType:"JSON",type:"GET",data:a,success:function(a){c.text(a.data.commission),g=null},error:function(a){o(a)}})}function n(a){return 1!=b&&(b=!0,$.ajax({url:"/ajax/cards/perform/",dataType:"JSON",type:"GET",data:r.serialize(),success:function(a){window.location.href="https://test.paymentgate.ru/rgsb/acsRedirect.do?orderId="+d.val(),b=!1},error:function(a){o(a)}}))}function o(a){void 0!==a.responseJSON._errors&&alert(a.responseJSON._errors[0])}var s=$("[data-transfer]"),r=(s.find("[data-transfer-loader]"),s.find("form")),l=s.find("[data-transfer-btn]"),d=s.find('[data-transfer-inp="orderId"]'),c=(s.find('[data-transfer-inps="paRes"]'),s.find("[data-transfer-amount]")),p=r.find("[data-transfer-inp]"),f=p.filter('[data-transfer-inp="main"]'),u=null,m=null,h=!1,v=null,g=null,b=!1;a(),f.on("keyup",function(){h=!1}),p.keyup(function(){m=e(f),u=e(p),m&&0==h&&(null!==v&&clearTimeout(v),null!==g&&g.abort(),v=setTimeout(function(){0==d.val().length?t(function(a){d.val(a.data.orderId),g=i(r.serialize()),v=null}):g=i(r.serialize()),h=!0,v=null},400)),u?l.prop("disabled",!1):l.prop("disabled",!0)}),l.on("click",n)},app.initGoto=function(){$("html").on("click.Goto","[data-goto]",function(a){a.preventDefault(),$("html, body").animate({scrollTop:$($(this).data("goto")).offset().top-$("[data-menu-wrap]").height()},500)})},app.masks=function(){$("[data-phone-mask]").mask("(000) 000-00-00",{clearIfNotMatch:!0})},app.initForms=function(){$("html").on("click.formError","[data-form-error]",function(){var a=$(this);return a.hasClass("_active")?a.removeClass("_active"):($("[data-form-error]").removeClass("_active"),a.addClass("_active")),!1}),$("html").on("click.closeErrors",function(a){$(a.targer).closest("[data-form-error]").length||$("[data-form-error]").removeClass("_active")})},app.chooseCity=function(){function a(a){p.removeClass("_active").filter('[data-city-letter="'+f+'"]').addClass("_active"),r.hide(),d=r.filter('[data-city-items-block="'+f+'"]'),c=d.find(l),c.removeClass("_disabled"),m&&m.slideTo(p.filter('[data-city-letter="'+f+'"]').index()),d.mCustomScrollbar({axis:"y",theme:"dark"}),d.show()}function e(){app.dom.$body.removeClass("choose-city"),i.fadeOut()}var t=$("[data-choose-city-btn]"),i=$("[data-city]"),n=i.find("[data-city-letters-gall]"),o=i.find("[data-city-form]"),s=i.find("[data-city-form-field]"),r=i.find("[data-city-items-block]"),l=i.find("[data-city-item]"),d=r.filter("._active"),c=d.find(l),p=i.find("[data-city-letter]"),f=p.filter("._active").data("cityLetter"),u=i.find("[data-city-close]"),m=!1;$.expr[":"].Contains=function(a,e,t){return 0==(a.textContent||a.innerText||"").toUpperCase().indexOf(t[3].toUpperCase())},o.on("submit",function(){return!1}),t.on("click",function(){$("html, body").animate({scrollTop:0},300),setTimeout(function(){app.dom.$body.addClass("choose-city"),i.fadeIn(),setTimeout(function(){!m&&n.length&&(m=new Swiper(n[0],{slidesPerView:"auto",simulateTouch:!0,spaceBetween:5}),gallInit=!0)},100)},300)}),u.on("click",e),d.mCustomScrollbar({axis:"y",theme:"dark"}),s.on("change",function(){var e=$(this),t=e.val(),i=null,n=null;t&&(i=t.charAt(0).toUpperCase(),n=d.find(".city__item-link:Contains("+t+")").closest(c),c.not(n).addClass("_disabled"),n.removeClass("_disabled"),d.mCustomScrollbar("scrollTo",n.first(),{scrollInertia:300}),i!=f&&(f=i,a(f)))}).keyup(function(){$(this).change()}),p.on("click",function(){var e=$(this);e.hasClass("_active")||(f=e.data("cityLetter"),a(f),s.val(""))})},app.fieldFilter=function(){var a=$("[data-field-filter]");$.expr[":"].Contains=function(a,e,t){return 0==(a.textContent||a.innerText||"").toUpperCase().indexOf(t[3].toUpperCase())},a.each(function(){var a=$(this),e=a.find("[data-field-filter-input]"),t=a.find("[data-filter-list]"),i=t.find("[data-filter-list-item]"),n=t.find("[data-filter-list-link]");t.hide(),e.keyup(function(){var a=$(this),e=a.val(),n=null;e?(n=t.find("[data-filter-list-link]:Contains("+e+")").closest(i),n.length?(i.not(n).hide(),n.show(),t.show()):t.hide()):t.hide()}),n.on("click",function(){e.val($(this).text()).change(),t.hide()})})},app.transfersMenu=function(){function a(){e.offset().top-$(document).scrollTop()-t.height()<=0?e.addClass("_fixed"):e.removeClass("_fixed")}var e=$("[data-transfers-menu]"),t=$("[data-menu-wrap]");if(app.utils.isMobile&&(e=$("[data-transfers-mob-menu]")),!e.length)return!1;var i=_.throttle(a,10);app.dom.$window.scroll(i),a()},app.initBaseCheck=function(){var a=$("[data-base-check]"),e=$("[data-base-check-wrap]");a.filter(":checked").each(function(){$(this).closest(e).addClass("_active")}),a.on("change",function(){$(this).closest(e).toggleClass("_active")})},app.initChosen=function(){$("[data-chosen]").chosen({disable_search_threshold:30,no_results_text:"Нет результатов для",width:"100%"})},app.initNav=function(){$("html").on("click.nav","[data-nav-btn]",function(){var a=$(this);a.toggleClass("_active").closest("[data-nav-block]").find("[data-nav-content]").slideToggle(500),a.closest("[data-nav-block]").find("[data-nav-text]").toggle()})},app.initTabs=function(){var a=null,e=null,t=null;$("html").on("click.tabs","[data-tabs-tab]",function(){var i=$(this);i.hasClass("_active")||i.hasClass("_disabled")||(a=i.closest("[data-tabs]"),e=a.find("[data-tabs-tab]"),t=a.find("[data-tabs-content]"),e.removeClass("_active"),i.addClass("_active"),t.hide().filter('[data-tabs-content="'+i.data("tabsTab")+'"]').show())})},app.mobMenu=function(){$("[data-mob-menu]")},app.menu=function(){function a(){return!app.dom.$body.hasClass("b-menu-visible")&&(app.dom.$document.scrollTop()>=o.height()?o.addClass("_fixed"):o.removeClass("_fixed"),void(app.utils.isMobile&&i()))}function e(){app.dom.$header.hasClass("_fixed")&&app.dom.$body.addClass("b-menu-visible-fixed"),g.addClass("_active"),w=app.dom.$window.scrollTop(),app.utils.isMobile?(c.filter('[data-menu-link="1"]').first().click(),i(),C||n(),C.slideTo(0,0)):(c.removeClass("_active"),p.hide(),app.dom.$body.addClass("b-menu-visible").removeClass("menu-visible"))}function t(){app.dom.$body.removeClass("b-menu-visible-fixed"),g.addClass("_hide-burger"),setTimeout(function(){g.removeClass("_hide-burger _active")},500),app.dom.$body.removeClass("menu-visible"),app.utils.isMobile?p.hide():app.dom.$body.removeClass("b-menu-visible"),app.dom.$window.scrollTop(w)}function i(){var a=Math.max(o.height()-app.dom.$document.scrollTop(),0);p.height(app.dom.$window.height()-a-d.height())}function n(){C=new Swiper(r[0],{slidesPerView:"auto",simulateTouch:!0,spaceBetween:25})}var o=$(".header"),s=$("[data-menu]"),r=$("[data-mob-menu]"),l=$("[data-menu-wrap]"),d=$("[data-menu-in]"),c=s.find("[data-menu-link]"),p=$("[data-menu-content]"),f=$("[data-header-search-btn]"),u=$("[data-header-search-close]"),m=$("[data-header-search-form]"),h=$("[data-header-search-form-field]"),v=$("[data-header-search-form-requests]"),g=$("[data-b-menu-btn]"),b=$("[ data-b-menu-sections-show]"),y=$("[ data-b-menu-sections]"),w=null,C=!1,_=null;f.on("click",function(){var a=$(this);a.hasClass("_active")?m.trigger("submit"):(o.addClass("search-open"),f.addClass("_active"),app.dom.$body.removeClass("menu-visible"),p.hide(),c.removeClass("_active"),app.utils.isMobile&&g.removeClass("_active"))}),u.on("click",function(){o.removeClass("search-open"),f.removeClass("_active"),h.val("").change(),v.hide()}),h.on("keyup",function(){clearTimeout(_),v.hide(),_=setTimeout(function(){var a=h.val();a?$.post(v.data("headerSearchFormRequests"),{q:a},function(a){a?v.html(a).slideDown(500):v.hide()}):v.hide()},1e3)}),m.on("submit",function(){if(!h.val())return!1;var a=$(this);$.post(a.attr("action"),a.serialize(),function(a){})}),app.utils.isMobile&&(c=r.find("[data-menu-link]")),a(),app.dom.$window.on("scroll.Menu",a),app.utils.isMobile||app.utils.isTablet||c.hover(function(){var a=$(this),e=a.data("menuLink");g.addClass("_hide-burger"),setTimeout(function(){g.removeClass("_hide-burger _active")},500),c.removeClass("_active"),a.addClass("_active"),p.hide(),p.filter('[data-menu-content="'+e+'"]').show(),app.dom.$body.removeClass("b-menu-visible").addClass("menu-visible"),app.dom.$body.removeClass("b-menu-visible-fixed")}),c.on("click",function(){var a=$(this),e=a.data("menuLink");app.utils.isMobile||(g.addClass("_hide-burger"),setTimeout(function(){g.removeClass("_hide-burger _active")},500)),p.hide(),app.dom.$body.removeClass("b-menu-visible").addClass("menu-visible"),app.dom.$body.removeClass("b-menu-visible-fixed"),c.removeClass("_active"),p.filter('[data-menu-content="'+e+'"]').show(),a.addClass("_active")}),b.on("click",function(){var a=$(this);a.hasClass("_active")?(y.hide(),app.dom.$body.removeClass("menu-sections-visible"),a.removeClass("_active")):(y.show(),a.addClass("_active"),app.dom.$body.addClass("menu-sections-visible "))}),app.dom.$window.on("click.CloseRequests",function(a){$(a.target).closest(y).length||$(a.target).closest(b).length||(y.hide(),app.dom.$body.removeClass("menu-sections-visible"),b.removeClass("_active"))}),l.hover(function(){},function(){app.dom.$body.removeClass("menu-visible"),p.hide(),c.removeClass("_active"),app.utils.isMobile&&g.removeClass("_active")}),g.on("click",function(){var a=$(this);a.hasClass("_active")?t():e()})},app.initFluid=function(){function a(){e<1440?$("html").css({"font-size":app.dom.$window.width()/e*t+"px"}):$("html").css({"font-size":Math.min(app.dom.$window.width(),e)/e*t+"px"})}var e=1440,t=10;app.utils.isTabletPort&&(e=768),app.utils.isMobile&&(e=414),a(),app.dom.$window.on("resize.Grid",a)},app.mobSliders=function(){var a=$("[data-mob-slider]");a.each(function(){new Swiper($(this)[0],{slidesPerView:1,simulateTouch:!0,breakpoints:{640:{spaceBetween:10}}})})},app.faqMobTabs=function(){var a=$("[data-faq-mob-tabs]");a.each(function(){new Swiper($(this)[0],{slidesPerView:"auto",simulateTouch:!0,breakpoints:{640:{spaceBetween:25}}})})},app.initSwitch=function(){var a=$("[data-switch-wrap]"),e=a.find("[data-switch]"),t=e.find("[data-switch-tab]"),i=a.find("[data-switch-content]"),n=e.find("[data-switch-inp]"),o=null;e.on("click",function(){$(this).toggleClass("_active"),t.toggleClass("_active"),o=t.filter("._active").data("switchTab"),n.val(o).change(),i.hide().filter('[data-switch-content="'+o+'"]').show()})},app.history=function(){var a,e,t,i,n=$("[data-history]"),o=n.find("[data-history-events]"),s=n.find("[data-history-in]"),r=o.find("[data-history-event]"),l=n.find("[data-history-scale]"),d=l.data("historyScale"),c=!1,p="mousedown",f="mouseup",u="mousemove";if(!n.length)return!1;var m=d.end-d.start;Modernizr.touch&&(p="touchstart",f="touchend",u="touchmove"),l.width(121.2*d.years+"rem"),i=new Swiper(o[0],{slidesPerView:1,simulateTouch:!0,autoHeight:!0,nextButton:$("[data-history-next]"),prevButton:$("[data-history-prev]"),onSlideChangeStart:function(){var a=l.find("[data-history-point]"),e=o.find(".swiper-slide-active").data("historyEvent"),t=a.filter('[data-history-point-event="'+e+'"]');a.removeClass("_active"),t.addClass("_active");var i=-t.position().left+s.width()/2;i=Math.max(Math.min(i,0),-(l.width()-s.width())),l.css("left",i+"px")}}),r.each(function(a,e){var t=$(this),i=t.data("historyEvent"),n=0==a?" _active":"",o=$('<div class="about__history-scale-point '+n+'" data-history-point-event="'+i+'" data-history-point ></div>');o.css("left",(i-d.start)/m*100+"%").appendTo(l),o.data("historyPoint",t)}),l.on("click","[data-history-point]",function(){var a=$(this),e=l.find("[data-history-point]");a.hasClass("_active")||(e.removeClass("_active"),a.addClass("_active"),i.slideTo(a.data("historyPoint").index()))}),l.on(p,function(t){c=!0,a=h(t),e=parseInt(l.css("left"))}),$(document).on(f,function(a){c=!1}),l.on(u,function(i){if(0==c)return!1;t=e+(h(i)-a);var n=e+(h(i)-a);n=Math.max(Math.min(n,0),-(l.width()-s.width())),l.css("left",n+"px")});var h=function(a){var e=0;if("touchstart"==a.type||"touchmove"==a.type||"touchend"==a.type||"touchcancel"==a.type){var t=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];e=t.pageX}else"mousedown"!=a.type&&"mouseup"!=a.type&&"mousemove"!=a.type&&"mouseover"!=a.type&&"mouseout"!=a.type&&"mouseenter"!=a.type&&"mouseleave"!=a.type||(e=a.pageX);return e}},app.tabletSliders=function(){var a=$("[data-tablet-slider]");a.each(function(){new Swiper($(this)[0],{slidesPerView:"auto",simulateTouch:!0,breakpoints:{640:{slidesPerView:1,spaceBetween:10}}})})},app.docsDateYears=function(){var a=$("[docs-date-years-gall]");a.each(function(){new Swiper($(this)[0],{slidesPerView:"auto",simulateTouch:!0,spaceBetween:60,breakpoints:{640:{spaceBetween:30}}})})},app.shareholdersChart=function(){var a=$("[data-shareholders-chart]"),e=a.data("shareholdersChart");if(!a.length)return!1;AmCharts.makeChart(a[0],{type:"pie",startDuration:0,theme:"none",addClassNames:!0,labelText:"",marginTop:10,marginBottom:10,marginLeft:10,marginRight:10,balloonText:"[[title]]<br><span style='font-size:14px'><b>[[value]]%</b></span>",legend:{position:"left",valueText:"[[value]]%",marginRight:10,autoMargins:!1},innerRadius:"60%",defs:{},dataProvider:e,valueField:"litres",titleField:"company","export":{enabled:!0}})},app.newsGall=function(){function a(a){d?(r.removeClass("_show _1 _2 _3 _4 _5 _6").addClass("_hidden"),setTimeout(function(){d.destroy(),e(a)},500)):e(a)}function e(a){r=s.find('[data-news-gall-item="'+a+'"]').clone(),o.html(r),r.slice(0,6).each(function(a,e){$(e).addClass("_"+(a+1))}),d=new Swiper(t[0],{slidesPerView:"auto",simulateTouch:!0,nextButton:n,prevButton:i,breakpoints:{640:{spaceBetween:10}}}),r=o.find("[data-news-gall-item]"),d.update(!0),d.slideTo(0,0),setTimeout(function(){r.addClass("_show")},100)}var t=$("[data-news-gall]"),i=t.find("[data-news-gall-prev]"),n=t.find("[data-news-gall-next]"),o=t.find("[data-news-gall-slides]"),s=$("[data-news-content]"),r=t.find("[data-news-gall-item]"),l=$("[data-news-tab]"),d=null;return!!t.length&&(l.on("click",function(){var e=$(this);e.hasClass("_active")||(l.toggleClass("_active"),a(e.data("newsTab")))}),void a(l.filter("._active").data("newsTab")))},app.bannerGall=function(){var a=$("[ data-banner-gall]"),e=a.find("[data-banner-gall-prev]"),t=a.find("[data-banner-gall-next]"),i=a.find("[data-banner-gall-pag]"),n=null,o=null,s=null,r=null,l=new Swiper(a[0],{nextButton:t,prevButton:e,pagination:i,paginationClickable:!0,autoplayDisableOnInteraction:!1,effect:"fade",loop:!0,onInit:function(){setTimeout(function(){o=a.find(".swiper-pagination-bullet-active").circleProgress({value:1,size:20,thickness:4,startAngle:-Math.PI/2,animation:{duration:7e3,easing:"linear"},emptyFill:"#ffffff",fill:{color:"#b31b2c"}}),n=a.find(".swiper-pagination-bullet-active").circleProgress("widget")},200),s=setTimeout(function(){l.slideNext()},7e3)},onSlideChangeStart:function(){n&&(a.find(".swiper-pagination-bullet-active").append(n),o.circleProgress("redraw")),clearTimeout(s),clearTimeout(r),r=setTimeout(function(){l.slideNext()},7e3)},onTouchEnd:function(){n&&(a.find(".swiper-pagination-bullet-active").append(n),o.circleProgress("redraw"))}})},app.info=function(){var a=$("[data-info]"),e=a.find("[data-info-form]"),t=a.find("[data-info-search]"),i=a.find("[data-info-field]"),n=a.find("[data-info-requests]"),o=a.find("[data-info-answer]");app.utils.isMobile&&(o=a.find("[data-info-answer-mob]")),i.on("keyup",function(){var a=$(this).val();a?e.trigger("submit"):n.hide()}),e.on("submit",function(){if(!i.val())return!1;o.hide().removeClass("_active");var a=$(this);return $.post(a.attr("action"),a.serialize(),function(a){n.html(a).slideDown(500)}),!1}),app.dom.$window.on("click.CloseRequests",function(a){$(a.target).closest(t).length||n.fadeOut()}),n.on("click","[data-requests-item]",function(){var a=$(this);i.val(a.text()),$.post(o.data("ajaxUrl"),{id:a.data("requestsItem")},function(a){var e=$(a);e.find("input[type=checkbox], input[type=radio]").idealRadioCheck(),n.hide(),o.html(e).show(),setTimeout(function(){o.addClass("_active")},50)})}),o.on("click","[data-answer-close]",function(){o.fadeOut(300),i.val(""),setTimeout(function(){o.removeClass("_active")},500)})},app.questions=function(){var a=$("[data-questions]"),e=a.find("[data-questions-item]"),t=e.find("[data-questions-item-title]"),i=e.find("[data-questions-item-answer]");t.on("click",function(){var a=$(this);a.hasClass("_active")?a.closest(e).find(i).slideUp(300):(i.slideUp(300),t.removeClass("_active"),a.closest(e).find(i).slideDown(300)),a.toggleClass("_active")})},app.compare=function(){var a=$("[data-deposit-compare]"),e=a.find("[data-deposit-compare-scroll]"),t=a.find("[data-deposit-compare-fixed]"),i=e.find("td").first().innerWidth()-t.width();e.mCustomScrollbar({axis:"x",theme:"dark",callbacks:{onTotalScrollBackOffset:i,onScroll:function(){t.addClass("_active")},onTotalScrollBack:function(){t.removeClass("_active")}}})},app.payFonds=function(){var a=$("[data-pay-fonds]"),e=a.find("[data-pay-fonds-items]"),t=a.find("[data-pay-fonds-more-btn]"),i=a.find("[data-pay-fonds-hidden]"),n=i.find("[data-pay-fonds-hidden-item]"),o=3;app.utils.isTabletPort&&(o=2),n.length||t.hide(),t.on("click",function(){var a=i.find("[data-pay-fonds-hidden-item]").slice(0,o);a.each(function(){var a=$(this);a.removeAttr("data-pay-fonds-hidden-item").removeClass("hide"),a.appendTo(e)}),i.find("[data-pay-fonds-hidden-item]").length||t.hide()})},app.depository=function(){var a=$("[data-depository]"),e=a.find("[data-depository-tab]"),t=a.find("form"),i=a.find("[data-depository-form-toggle]"),n=a.find("[data-depository-form-fields]"),o=a.find("[data-depository-field]"),s=a.find("[data-depository-type]"),r=a.find("[data-depository-block]"),l=a.find("[data-depository-show-more]"),d=a.find("[data-depository-hidden]"),c=3;app.utils.isTabletPort&&(c=2),d.find("[data-depository-hidden-item]").length||l.hide(),i.on("click",function(){$(this).toggleClass("_active"),n.slideToggle()}),e.on("click",function(){var a=$(this);a.hasClass("_active")||(e.removeClass("_active"),a.addClass("_active"),s.val(a.data("depositoryTab")),o.val("").trigger("chosen:updated"),t.trigger("submit"))}),l.on("click",function(){var a=d.find("[data-depository-hidden-item]").slice(0,c);a.each(function(){var a=$(this);a.removeAttr("data-depository-hidden-item"),a.appendTo(r)}),d.find("[data-depository-hidden-item]").length||l.hide()}),t.on("submit",function(){var a=$(this);return $.post(a.attr("action"),a.serialize(),function(a){r.html(a.content),a.hidden?d.html(a.hidden):d.empty(),d.find("[data-depository-hidden-item]").length?l.show():l.hide()},"json"),!1})},app.resumeForm=function(){var a=$("[data-resume-form-block]"),e=$("[data-resume-form-show]"),t=a.find("[data-form-errors]");e.on("click",function(){a.find("form").show(),a.find("[data-success]").hide(),$.fancybox({wrapCSS:"fc-base _forms",content:a,fitToView:!1,padding:0,helpers:{overlay:{css:{background:"rgba(0, 0, 0, 0.5)"}}}})}),a.find("form").on("submit",function(){var e=$(this),i=new FormData(e.get(0));return $.ajax({url:e.attr("action"),type:"POST",contentType:!1,processData:!1,data:i,dataType:"json",success:function(e){e.errors?t.html(e.errors).show():(t.hide(),a.find("form").hide(),a.find("[data-success]").show())}}),!1})},app.vacancies=function(){var a=$("[data-vacancies]"),e=a.find("[data-vacancies-form-block]"),t=e.find("form"),i=a.find("[data-vacancies-form-toggle]"),n=a.find("[data-vacancies-form-fields]"),o=a.find("[data-vacancies-block]"),s=a.find("[data-vacancies-list]"),r=$("[data-resume-form]"),l=r.find("[data-form-errors]"),d=r.find("[data-resume-form-position]"),c=r.find("[data-resume-form-email]");i.on("click",function(){$(this).toggleClass("_active"),n.slideToggle()}),t.on("submit",function(){var a=$(this);return $.post(a.attr("action"),a.serialize(),function(a){a.content?(s.html(a.content),o.fadeIn(300)):o.hide()},"json"),!1}),r.find("form").on("submit",function(){var a=$(this),e=new FormData(a.get(0));return $.ajax({url:a.attr("action"),type:"POST",contentType:!1,processData:!1,data:e,dataType:"json",success:function(a){a.errors?l.html(a.errors).show():(l.hide(),r.find("form").hide(),r.find("[data-success]").show())}}),!1}),s.on("click","[data-resume-btn]",function(){var a=$(this),e=a.data("resumeBtn");return l.hide(),r.find("form").show(),r.find("[data-success]").hide(),d.val(e.title),c.val(e.email),$.fancybox({wrapCSS:"fc-base _forms",content:r,fitToView:!1,padding:0,helpers:{overlay:{css:{background:"rgba(0, 0, 0, 0.5)"}}}}),!1})},app.initAnimations=function(){function a(){i=$(document).scrollTop(),n=app.dom.$window.height(),e.each(function(){var a=$(this);t=a.offset().top+.15*n,t-i<=n&&a.addClass("_active")})}var e=$("[data-animation]"),t=null,i=null,n=null,o=_.throttle(a,100);app.dom.$window.scroll(o),a()},app.initMaps=function(){var a=document.createElement("script");a.type="text/javascript",a.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAjgwJYKE3QnRDq8snccgJY499WUZrwTn0&v=3.exp&sensor=true&callback=initialize",document.body.appendChild(a),window.initialize=function(){app.offices(),app.office()}},app.offices=function(){function a(){I.on("submit",function(){var a=$(this);return $.post(a.attr("action"),a.serialize(),function(a){N.html($(a.content).html()),R.show(),F.text(" "+a.counter+" "+app.utils.okonchanie(a.counter,"отделение","отделения","отделений"))},"json"),!1}),S.find("option").each(function(){var a=$(this),e=null;a.data("metroId")&&(e=$('<div class="offices__metro-img-station _'+a.data("metroId")+'"></div>'),e.on("click",function(){a.prop("selected",!0),S.change().trigger("chosen:updated")}),P.append(e))}),S.on("change",function(){var a=S.find("option:selected").data("metroId");P.find(".offices__metro-img-station").removeClass("_active").filter("._"+a).addClass("_active"),$(this).val()?I.trigger("submit"):(N.empty(),R.hide())})}function e(a){var e=new google.maps.LatLngBounds,t=null;a.first().data("officePoint");a.each(function(){var a=$(this),i=a.data("officePoint"),n=new google.maps.LatLng(i.lat,i.lan);e.extend(n);var o=new google.maps.Marker({position:{lat:i.lat,lng:i.lan},map:z,icon:r["static"],$dom:a});o.addListener("click",function(){t&&t.setIcon(r["static"]),t=this,o.setIcon(r.active),f.html(o.$dom.clone()),p.addClass("_show"),p.data("marker",o)}),M.push(o)}),1==a.length?(z.setCenter(e.getCenter()),z.setZoom(12)):("МОСКВА"==k.val().toUpperCase()?z.setCenter({lat:55.755826,lng:37.6173},12):z.setCenter(e.getCenter(),12),z.setZoom(Math.max(z.getZoom(),12)))}function t(a){for(var e=0;e<M.length;e++)M[e].setMap(a)}function i(){t(null)}function n(){i(),M=[]}var o=$("[data-offices]"),s=o.find("[data-offices-metro]"),r=o.data("markerUrl"),l=o.find("[data-offices-tab]"),d=o.find('[data-offices-tab="metro"]'),c=o.find("[data-offices-content]"),p=o.find("[data-offices-map-popup]"),f=p.find("[data-offices-map-popup-content]"),u=p.find("[data-offices-map-popup-close]"),m=o.find("[data-offices-map]")[0],h=o.find("[data-office-point]"),v=o.find("[data-zoom-plus]"),g=o.find("[data-zoom-minus]"),b=o.find("[data-filter]"),y=b.find("[data-filter-extend]"),w=b.find("[data-filter-extend-show]"),C=b.find("[data-filter-extend-close]"),_=b.find("[data-offices-filter-metro]"),x=b.find("form"),k=b.find(".offices__filter-city-field"),T=b.find('input[type="text"],input[type="hidden"],input[type="checkbox"],select'),M=[],I=null,S=null,N=null,P=null,R=null,F=null;
if(!o.length)return!1;s.length&&(I=s.find("form"),S=s.find("[data-offices-metro-field]"),N=s.find("[data-offices-metro-items]"),R=$("[data-offices-metro-counter]"),F=s.find("[data-offices-metro-counter-val]"),P=s.find("[data-offices-metro-img]"),a()),k.on("change",function(){p.removeClass("_show")});var E={zoom:11,center:new google.maps.LatLng(55.74822645,37.69954205),mapTypeControl:!1,streetViewControl:!1,zoomControl:!1,overviewMapControl:!1,scrollwheel:!1,cancelable:!0},z=new google.maps.Map(m,E),A=[{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"simplified"}]},{featureType:"road",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{visibility:"simplified"}]},{featureType:"transit",stylers:[{visibility:"simplified"}]},{featureType:"landscape",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",stylers:[{visibility:"off"}]},{featureType:"road.local",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"water",stylers:[{color:"#84afa3"},{lightness:52}]},{stylers:[{saturation:-77}]},{featureType:"road"}];z.setOptions({styles:A}),e(h),v.click(function(a){a.preventDefault(),z.setZoom(z.getZoom()+1)}),g.click(function(a){a.preventDefault(),z.setZoom(z.getZoom()-1)}),u.on("click",function(){p.removeClass("_show"),p.data("marker").setIcon(r["static"]),setTimeout(function(){f.empty()},300)}),"МОСКВА"==k.val().toUpperCase()&&o.addClass("_show-metro"),l.on("click",function(){var a=$(this);return!a.hasClass("_active")&&(l.removeClass("_active"),a.addClass("_active"),void c.hide().filter('[data-offices-content="'+a.data("officesTab")+'"]').fadeIn(300))}),"МОСКВА"==k.val().toUpperCase()?(o.addClass("_show-metro"),d.show()):(o.removeClass("_show-metro"),d.hide()),x.on("submit",function(){var a=$(this);return"МОСКВА"==k.val().toUpperCase()?(o.addClass("_show-metro"),d.show()):(o.removeClass("_show-metro"),d.hide(),d.hasClass("_active")&&l.filter('[data-offices-tab="map"]').click().addClass("_active")),$.post(a.attr("action"),a.serialize(),function(a){var t=$(a.content).find("[data-office-point]");c.filter('[data-offices-content="list"]').html(t),a.metro?(_.show().html($(a.metro)).find("[data-chosen]").chosen({disable_search_threshold:1e3,width:"100%"}),_.find("select").on("change",function(){x.trigger("submit")})):_.empty().hide(),n(),e(t)},"json"),!1}),T.on("change",function(){x.trigger("submit")}),w.on("click",function(){w.addClass("_active"),y.show()}),C.on("click",function(){w.removeClass("_active"),y.hide()})},app.office=function(){var a=$("[data-office]"),e=(a.data("markerUrl"),a.find("[data-office-map]")[0]),t=a.find("[data-zoom-plus]"),i=a.find("[data-zoom-minus]"),n=a.data("office");if(!a.length)return!1;var o={zoom:16,center:new google.maps.LatLng(n.lat,n.lan),mapTypeControl:!1,streetViewControl:!1,zoomControl:!1,overviewMapControl:!1,scrollwheel:!1,cancelable:!0},s=new google.maps.Map(e,o),r=[{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"simplified"}]},{featureType:"road",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{visibility:"simplified"}]},{featureType:"transit",stylers:[{visibility:"simplified"}]},{featureType:"landscape",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",stylers:[{visibility:"off"}]},{featureType:"road.local",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"water",stylers:[{color:"#84afa3"},{lightness:52}]},{stylers:[{saturation:-77}]},{featureType:"road"}];s.setOptions({styles:r});var l=new google.maps.Marker({position:{lat:n.lat,lng:n.lan},map:s,icon:n.markerUrl});l.setMap(s),t.click(function(a){a.preventDefault(),s.setZoom(s.getZoom()+1)}),i.click(function(a){a.preventDefault(),s.setZoom(s.getZoom()-1)})},app.formatNumber=function(a){return String(a).replace(/(?=\B(?:\d{3})+\b)/g," ")},app.calcFilter=function(){function a(){var a=parseInt(t.val().replace(new RegExp(" ","g"),""),10)||0,r=i.val(),l=n.val(),d=e.find("input[name=monthly]").is(":checked")?"Y":"N",c=e.find("input[name=cashin]").is(":checked")?"Y":"N",f=e.find("input[name=cashout]").is(":checked")?"Y":"N";o.empty().hide();var u=0;if(a>0){t.removeClass("error");for(var m in p){var h=p[m];if(("Y"!=d||"Y"==h.monthly)&&!("Y"==c&&"Y"!=h.cashin||"Y"==f&&"Y"!=h.cashout)){var v=0,g=0;if("undefined"!=typeof h[r]&&"undefined"!=typeof h[r][l])for(var b in h[r][l])b=parseInt(b),b<=a&&(g=h[r][l][b],v=(l/365*(g/100)+1)*a);if(v>0){u++;var y='<div class="deposit-card '+h["class"]+'"> <div class="deposit-card__ico" style="background-image: url('+h.img+');"></div> <div class="deposit-card__inner"> <div class="deposit-card__top"> <div class="deposit-card__main"><div class="deposit-card__title">'+h.name+'</div> <div class="deposit-card__text">'+h.descr+'</div> </div> <div class="deposit-card__info"> <div class="deposit-card__info-block"> <div class="deposit-card__info-block-title">СРОК ВКЛАДА</div> <div class="deposit-card__info-block-text">'+n.find("option:selected").text()+'</div> </div><div class="deposit-card__info-block"><div class="deposit-card__info-block-title">СТАВКА, ДО</div><div class="deposit-card__info-block-text">'+g.toFixed(2)+' %</div></div></div></div><div class="deposit-card__btns"><a href="'+h.url+'?goto=.subscription" class="btn deposit-card__btn">ОТКРЫТЬ ВКЛАД</a><a href="'+h.url+'" class="btn deposit-card__btn _transparent">УЗНАТЬ ПОДРОБНЕЕ</a></div></div></div>';o.append(y)}}}}else t.addClass("error");u>0?(o.show(),s.text("Вам подходит "+u+" "+app.utils.okonchanie(u,"вклад","вклада","вкладов"))):(o.hide(),s.text("Вкладов, по заданным Вами параметрам, не найдено. Рекомендуем воспользоваться сравнительной таблицей для выбора наиболее удобных для Вас вариантов"))}var e=$("[data-calc-filter]"),t=e.find("[data-calc-filter-sum]"),i=e.find("[data-calc-filter-currency]"),n=e.find("[data-calc-filter-period]"),o=e.find("[data-calc-filter-result]"),s=e.find("[data-calc-filter-counter]"),r=e.find("[data-base-check-wrap]"),l=r.find("[data-base-check]"),d=e.find("form"),c=e.find("[data-calc-filter-reset]"),p=[];return!!e.length&&($.post(d.attr("action"),{},function(a){p=$.parseJSON(a)}),t.on("change",function(){var e=parseInt(t.val().replace(new RegExp(" ","g"),""));e=e||"",t.val(app.formatNumber(e)),a()}),l.on("change",a),i.on("change",a),n.on("change",a),void c.on("click",function(){d.trigger("reset"),n.trigger("chosen:updated"),i.trigger("chosen:updated"),r.removeClass("_active").find(".ideal-check").removeClass("checked"),s.empty(),o.hide()}))},app.calc=function(){function a(){u.slider({range:"min",min:p.min,max:p.max,step:p.step,value:p.value||p.min,slide:function(a,e){m.val(app.formatNumber(e.value))},start:function(a,e){D=e.value},stop:function(a,e){e.value!=D&&(s(),m.val(app.formatNumber(e.value)))}}),m.focus(function(){V=parseInt(m.val().replace(new RegExp(" ","g"),""),10),m.val(V)}).keyup(function(){}),n(),e(),h.text(app.formatNumber(p.min)),v.text(app.formatNumber(p.max)),m.val(app.formatNumber(p.value)).change(),m.on("change",function(){var a=parseInt(m.val().replace(new RegExp(" ","g"),""),10)||p.min;V=Math.min(Math.max(p.min,a),p.max),u.slider("value",V),m.val(app.formatNumber(V)),s()}),y.length&&i(),s()}function e(){var a=0;for(var e in c.currency)g.append($('<option value="'+e+'">'+c.currency[e]+"</option>")),a++;g.trigger("chosen:updated"),a<2&&g.closest("[data-calc-valuta]").hide()}function t(){w.empty(),C.empty(),1===p.periodsCounter?d.addClass("hide-periods"):d.removeClass("hide-periods");var a=1;for(var e in p.periods)e=parseInt(e),C.append($('<div class="deposit-calc__option-scale-item _period _'+p.periodsCounter+"-"+a+'">'+e+"</div>")),w.append($('<option value="'+e+'">'+e+" "+app.utils.okonchanie(e,"день","дня","дней")+"</option>")),a++;w.trigger("chosen:updated")}function i(){t(),y.slider({range:"min",min:1,max:p.periodsCounter,value:w[0].selectedIndex+1,slide:function(a,e){w[0].selectedIndex=e.value-1,w.trigger("chosen:updated"),s()}}),w.on("change",function(){y.slider("value",this.selectedIndex+1),s()})}function n(){return"Y"!=c.monthly?(d.addClass("hide-monthly"),!1):(T.val(app.formatNumber(p.monthlyValue)).change(),M.text(app.formatNumber(p.monthlyMin)),I.text(app.formatNumber(p.monthlyMax)),k.slider({range:"min",min:p.monthlyMin,max:p.monthlyMax,step:p.monthlyStep,value:p.monthlyValue||p.monthlyMin,slide:function(a,e){T.val(app.formatNumber(e.value))},start:function(a,e){j=e.value},stop:function(a,e){e.value!=j&&(s(),T.val(app.formatNumber(e.value)))}}),T.on("change",function(){var a=parseInt(T.val().replace(new RegExp(" ","g"),""),10);V=Math.min(Math.max(p.monthlyMin,a),p.monthlyMax),k.slider("value",V),T.val(app.formatNumber(V)),s()}),T.focus(function(){V=parseInt(T.val().replace(new RegExp(" ","g"),""),10),T.val(V)}).keyup(function(){}),void x.on("change",function(){$(this).is(":checked")?(S=!0,_.removeClass("_disabled")):(S=!1,_.addClass("_disabled")),s()}))}function o(a){var e=1;switch(a){case 31:e=1;break;case 91:e=3;break;case 181:e=6;break;case 271:e=9;break;case 367:e=12;break;case 732:e=24;break;case 1080:e=36}return e}function s(){F=parseInt(m.val().replace(new RegExp(" ","g"),""),10),E=parseInt(T.val().replace(new RegExp(" ","g"),""),10),z=parseInt(w.val());for(var a in p.periods[z])a=parseInt(a),a<=F&&(O=p.periods[z][a],O=+O);N.text(O.toFixed(2)+"%"),"Y"==c.monthly&&S&&0!=E?(A=parseInt(r(F,E,O,o(z))),F+=E*(o(z)-1)):A=Math.floor(F*z*O/100/365),P.html(app.formatNumber(A)+" "+l(B)),R.html(app.formatNumber(A+F)+" "+l(B))}function r(a,e,t,i){var n=0,o=0;for(o=0;o<i;o++)n+=a*t/100/12,a+=e;return n}function l(a){return"rur"==a?'<span class="rub _medium"></span>':"usd"==a?"$":"€"}var d=$("[data-calc]"),c=null,p=null,f=d.find("[data-calc-sum]"),u=f.find("[data-calc-sum-slider]"),m=f.find("[data-calc-sum-inp]"),h=f.find("[data-calc-sum-min]"),v=f.find("[data-calc-sum-max]"),g=d.find("[data-calc-valuta-select]"),b=d.find("[data-calc-period]"),y=b.find("[data-calc-period-slider]"),w=b.find("[data-calc-period-select]"),C=b.find("[data-calc-period-scale]"),_=d.find("[data-calc-monthly]"),x=_.find("[data-calc-monthly-check]"),k=_.find("[data-calc-monthly-slider]"),T=_.find("[data-calc-monthly-inp]"),M=_.find("[data-calc-monthly-from]"),I=_.find("[data-calc-monthly-to]"),S=!0,N=d.find("[data-calc-rate]"),P=d.find("[ data-calc-profit]"),R=d.find("[data-calc-total-sum]"),F=null,E=null,z=null,A=null,O=null,B="rur",D=null,j=null,V=null;return!!d.length&&($.post(d.data("calcInfoUrl"),{},function(e){c=$.parseJSON(e),c=c[d.data("calc")],p=c[B],a()}),void g.on("change",function(){B=g.val(),p=c[B],s(),u.slider("option","max",p.max),u.slider("option","min",p.min),u.slider("option","step",p.step),m.change(),t(),k.slider("option","min",p.monthlyMin),k.slider("option","max",p.monthlyMax),k.slider("option","step",p.monthlyStep),M.text(app.formatNumber(p.monthlyMin)),I.text(app.formatNumber(p.monthlyMax)),T.change(),h.text(app.formatNumber(p.min)),v.text(app.formatNumber(p.max)),w.trigger("chosen:updated"),w.find('option[value="'+z+'"]').length&&w.val(z),y.slider("option","max",p.periodsCounter),w.change()}))},app.mortgageCalc=function(){function a(){f.slider({range:"min",min:5,max:20,step:1,value:13,slide:function(a,e){u.val(app.formatNumber(e.value))},start:function(a,e){i=e.value},stop:function(a,e){e.value!=i&&(u.val(e.value+" лет"),t())}}),d.focus(function(){var a=parseInt(d.val().replace(new RegExp(" ","g"),""),10);d.val(a)}).keyup(function(){}),d.on("change",function(){var a=parseInt(d.val().replace(new RegExp(" ","g"),""),10);d.val(app.formatNumber(a)),c.val(app.formatNumber(Math.min(a,parseInt(c.val().replace(new RegExp(" ","g"),""),10)))),t()}),c.focus(function(){var a=parseInt(c.val().replace(new RegExp(" ","g"),""),10);c.val(a)}).keyup(function(){}),c.on("change",function(){var a=parseInt(c.val().replace(new RegExp(" ","g"),""),10);a=Math.min(a,parseInt(d.val().replace(new RegExp(" ","g"),""),10)),c.val(app.formatNumber(a)),t()}),u.focus(function(){var a=parseInt(u.val().replace(new RegExp(" ","g"),""),10);u.val(a)}).keyup(function(){}),u.on("change",function(){var a=parseInt(u.val().replace(new RegExp(" ","g"),""),10);R=Math.min(Math.max(5,a),20),f.slider("value",R),u.val(app.formatNumber(R)+" лет"),t()}),t()}function e(){E&&app.dom.$document.scrollTop()>=o.offset().top&&app.dom.$document.scrollTop()<o.offset().top+o.height()-100?r.show():r.hide()}function t(){s.find("[data-mortgage-calc-schedule-row]").remove(),F&&F.remove(),x=parseInt(d.val().replace(new RegExp(" ","g"),""),10),k=parseInt(c.val().replace(new RegExp(" ","g"),""),10),I=12*parseInt(u.val()),T=x-k,M=(T*(P+P/(Math.pow(1+P,I)-1))).toFixed(0),S=(M*I-T).toFixed(0),m.text((100*N).toFixed(2)),h.text(app.formatNumber(T)),g.text(app.formatNumber(M)),v.text(app.formatNumber(S));var a=T,e="",t=null,i=null;F=$('<tr class="deposit-table__row mortgage-calc__schedule-more" data-mortgage-calc-schedule-more><td colspan="5"><div class="mortgage-calc__schedule-more-btn-wrap"><a href="javascript:void(0);" data-mortgage-calc-schedule-more-btn class="mortgage-calc__schedule-more-btn">Развернуть</a></div></td></tr>');for(var n=1;n<=I;n++){t=(a*N/12).toFixed(0),e=n>5&&I-n>2?"  _hidden":" ",C=b[(y+n-1)%12],_=w+Math.floor((n+1)/12),i=n==I?0:app.formatNumber((a-(M-t)).toFixed(0));var o=$('<tr class="deposit-table__row '+e+'" data-mortgage-calc-schedule-row><td class="_bold">'+C+", "+_+"</td><td>"+app.formatNumber(M)+"</td><td>"+app.formatNumber((M-t).toFixed(0))+"</td><td>"+app.formatNumber(t)+'</td><td class="_bold">'+i+"</td></tr>");a-=M-t,s.append(o),5==n&&s.append(F)}}var i,n=$("[data-mortgage-calc]"),o=$("[data-mortgage-calc-schedule-wrap]"),s=o.find("[data-mortgage-calc-schedule]"),r=$("[data-mortgage-calc-schedule-minimize]"),l=r.find("[data-mortgage-calc-schedule-minimize-btn]"),d=n.find("[data-mortgage-calc-price]"),c=n.find("[data-mortgage-calc-initial]"),p=n.find("[data-mortgage-calc-period]"),f=p.find("[data-mortgage-calc-period-slider]"),u=p.find("[data-mortgage-calc-period-inp]"),m=n.find("[data-mortgage-calc-rate]"),h=n.find("[data-mortgage-calc-sum]"),v=n.find("[data-mortgage-calc-overpay]"),g=n.find("[data-mortgage-calc-payment]"),b=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],y=n.data("month"),w=n.data("year"),C=null,_=null,x=null,k=null,T=null,M=null,I=null,S=null,N=.1295,P=N/12,R=null,F=null,E=!1;return!!n.length&&(a(),s.on("click","[data-mortgage-calc-schedule-more-btn]",function(){$(this).closest("[data-mortgage-calc-schedule-more]").remove(),$("[data-mortgage-calc-schedule-row]").filter("._hidden").show(),E=!0,e()}),l.on("click",function(){r.hide();var a=$("[data-mortgage-calc-schedule-row]").filter("._hidden");a.hide(),E=!1,F.insertBefore(a.first()),e(),setTimeout(function(){$("html, body").stop(!0,!0).animate({scrollTop:o.offset().top-$("[data-menu-wrap]").height()},10)},100)}),e(),void app.dom.$window.on("scroll.Schedule",e))};